| Id | Steps                                                                                                                                                                                                                      | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1  | First, we will create the container image, and navigate to the example2/example2-image folder.<br><br>Build the docker image (pointing to the localhost registry) and load it to minikube.                                 | #Current directory<br>`$ pwd`<br>/home/maheshp/Desktop/iatcp-telepresence-maheshp-telepresence-examples-v1/example2<br>Â <br>#Navigate to example2-image<br>`$ cd example2-image/`<br>Â <br>\# Building the image<br>`$ docker build -t example2 .Â `<br>Â <br>#Load the image to minikube<br>`$ minikube image load example2`<br>Â <br>#Navigate back to application folder<br>`$ cd ..`                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 2  | This static file will be provided to the deployment via a volume mount(host path), hence first we will create index.html in our K8s node                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 3  | SSH to the K8s node                                                                                                                                                                                                        | #We are using Minkube for creating the K8s cluster with container driver as docker.The below command will ssh to minikube #node<br>`$ minikube ssh`<br>docker@minikube:~$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 4  | Create a folder and home.html that will be used in the volume mount.                                                                                                                                                       | #creating the folder in the mount path<br>`docker@minikube:~$ sudo mkdir /mnt/data`<br>Â <br>#move to the data folder<br>`docker@minikube:~$cd /mnt/data`<br>`docker@minikube:/mnt/data$ sudo vi home.html`<br>Â <br>#Add the below html code and save<br>`<!DOCTYPE html>`<br>`<html>`<br>Â Â Â  `<head>`<br>Â Â Â Â Â Â Â  `<meta charset="UTF-8">`<br>Â `Â Â Â Â Â Â  <title>Environment variable values declared at container level</title>`<br>`Â Â Â  </head>`<br>`Â Â Â  <body>`<br>Â `Â Â Â Â Â Â  <h1>Environment Variable Values:</h1>`<br>Â `Â Â Â Â Â Â  <ul>`<br>Â Â `Â Â Â Â Â Â Â Â Â  <li><strong>{{ .EnvVariableName }} = </strong> {{ .EnvVariableValue }}</li><!-- Display the value of the environment variable here -->`<br>Â `Â Â Â Â Â Â  </ul>`<br>`Â Â Â  </body>`<br>`</html>`<br>Â <br>#Exit the node<br>`docker@minikube:~$ exit`<br>                          |
| 5  | Create the deployment using the "my-microservice" helm chart in example2/helm directory                                                                                                                                    | #Navigate to helm directory<br>`$ cd helm/`<br>Â <br>`$ pwd`<br>/home/maheshp/Desktop/iatcp-telepresence-maheshp-telepresence-examples-v1/example2/helm<br>Â <br>#helm install <name of release><br>`$ helm install mahesh my-microservice`<br>Â <br>#Once the Deployments are ready we can launch the service in browser with minikube service <service name><br>`$ minikube service mahesh-my-microservice`                                                                                                                                                                                                                                                                                                                                                                                              |
| 6  | We can see that the home.html in the volume mount is now being served with environment variables at the K8s cluster level like KUBERNETETETES_SERVICE_HOST AND KUBERNETETETES_SERVICE_PORT,Â  at the K8s Cluster node port. | #Once the Deployments are ready we can launch the service in browser with "minikube service <service name>"<br>`$ minikube service mahesh-my-microservice`<br>`|-----------|------------------------|-------------|---------------------------|`<br>`| NAMESPACE |Â Â Â Â Â Â Â Â Â  NAMEÂ Â Â Â Â Â Â Â Â  | TARGET PORT |Â Â Â Â Â Â Â Â Â Â Â  URLÂ Â Â Â Â Â Â Â Â Â Â  |`<br>`|-----------|------------------------|-------------|---------------------------|`<br>`| defaultÂ Â  | mahesh-my-microservice | http/5000Â Â  | http://192.168.49.2:30260 |`<br>`|-----------|------------------------|-------------|---------------------------|`<br>ðŸŽ‰Â  Opening service default/mahesh-my-microservice in default browser...<br>Â <br>#This will provide <the Node-IP>:<Node-Port> URL of the K8s cluster and launch the same in your default browser. |
